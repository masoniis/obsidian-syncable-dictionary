/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GlobalDictionarySyncPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/privateDictAPI.ts
var PrivateDictAPI = class {
  constructor() {
    const electron = require("electron");
    if (electron && electron.remote) {
      const remote = electron.remote;
      const currentWebContents = remote.getCurrentWebContents();
      this.session = currentWebContents.session;
    }
  }
  addWord(newEntry) {
    this.session.addWordToSpellCheckerDictionary(newEntry);
  }
  removeWord(word) {
    this.session.removeWordFromSpellCheckerDictionary(word);
  }
  async listWords() {
    return await this.session.listWordsInSpellCheckerDictionary();
  }
};
var privateDictAPI = new PrivateDictAPI();

// src/ui/settingsTab.ts
var import_obsidian = require("obsidian");
var GlobalDictionarySettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.filteredWords = [];
    this.plugin = plugin;
  }
  refresh() {
    this.filteredWords = [...this.plugin.settings.globalWords];
    this.updateWordCount();
    this.renderWordsList();
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    document.body.classList.add("global-dictionary-settings");
    this.addStyles();
    containerEl.createEl("h2", { text: "Global Dictionary Sync Settings" });
    const addWordSetting = new import_obsidian.Setting(containerEl).setName("Add Word to Dictionary").setDesc("Enter a word to add to your global dictionary.");
    const addWordContainer = addWordSetting.controlEl.createDiv(
      "dictionary-add-container"
    );
    const addWordInput = addWordContainer.createEl("input", {
      attr: {
        type: "text",
        placeholder: "Enter a word..."
      },
      cls: "dictionary-add-input"
    });
    const addWordButton = addWordContainer.createEl("button", {
      text: "Add Word",
      cls: "dictionary-add-button"
    });
    addWordButton.addEventListener("click", async () => {
      const word = addWordInput.value.trim();
      if (word) {
        if (!this.plugin.settings.globalWords.includes(word)) {
          try {
            privateDictAPI.addWord(word);
          } catch (e) {
            new import_obsidian.Notice(
              `NOTE: Updating dict doesn't work on iOS (untested on android).

 Can't update dictionary: ${e}.`
            );
            return;
          }
          this.plugin.settings.globalWords.push(word);
          this.plugin.settings.globalWords.sort(
            (a, b) => a.toLowerCase().localeCompare(b.toLowerCase())
          );
          await this.plugin.saveSettings();
          new import_obsidian.Notice(`'${word}' added to dictionary.`);
          addWordInput.value = "";
          this.filterWords();
          this.updateWordCount();
        } else {
          new import_obsidian.Notice(`'${word}' is already in your dictionary.`);
        }
      }
    });
    const dictionarySetting = new import_obsidian.Setting(containerEl).setName("Search Global Dictionary").setDesc("Search and remove words from your dictionary.");
    const searchContainer = dictionarySetting.controlEl.createDiv(
      "dictionary-search-container"
    );
    this.searchInput = searchContainer.createEl("input", {
      attr: {
        type: "text",
        id: "dictionary-search",
        placeholder: "Type to filter words..."
      }
    });
    this.searchInput.addEventListener("input", () => {
      this.filterWords();
    });
    const wordsContainer = containerEl.createDiv("dictionary-words-container");
    this.wordsList = wordsContainer.createDiv("dictionary-words-list");
    this.countIndicator = containerEl.createDiv("dictionary-count");
    this.countIndicator.createSpan({
      text: `Total words in dictionary: ${this.plugin.settings.globalWords.length}`
    });
    this.filteredWords = [...this.plugin.settings.globalWords];
    this.renderWordsList();
  }
  filterWords() {
    const searchTerm = this.searchInput.value.toLowerCase();
    if (searchTerm) {
      this.filteredWords = this.plugin.settings.globalWords.filter(
        (word) => word.toLowerCase().includes(searchTerm)
      );
    } else {
      this.filteredWords = [...this.plugin.settings.globalWords];
    }
    this.renderWordsList();
  }
  updateWordCount() {
    if (this.countIndicator) {
      this.countIndicator.empty();
      this.countIndicator.createSpan({
        text: `Total words in dictionary: ${this.plugin.settings.globalWords.length}`
      });
    }
  }
  renderWordsList() {
    this.wordsList.empty();
    if (this.filteredWords.length === 0) {
      if (this.searchInput.value) {
        this.wordsList.createEl("p", {
          text: "No matching words found.",
          cls: "dictionary-empty-message"
        });
      } else {
        this.wordsList.createEl("p", {
          text: 'No words in the dictionary yet. Use the command "Add selection to Global Dictionary" to add some!',
          cls: "dictionary-empty-message"
        });
      }
      return;
    }
    const ul = this.wordsList.createEl("ul", { cls: "dictionary-words-ul" });
    this.filteredWords.forEach((word) => {
      const li = ul.createEl("li", { cls: "dictionary-word-item" });
      li.createSpan({ text: word, cls: "dictionary-word-text" });
      const removeButton = li.createEl("button", {
        text: "Remove",
        cls: "dictionary-remove-button"
      });
      removeButton.addEventListener("click", async () => {
        try {
          privateDictAPI.removeWord(word);
          this.plugin.settings.globalWords = this.plugin.settings.globalWords.filter((w) => w !== word);
          await this.plugin.saveSettings();
          new import_obsidian.Notice(`'${word}' removed from dictionary.`);
          this.filterWords();
          this.updateWordCount();
        } catch (e) {
          new import_obsidian.Notice(
            `NOTE: Updating dict doesn't work on iOS (untested on android).

Error removing word: ${e}.`
          );
        }
      });
    });
  }
  addStyles() {
    if (!document.getElementById("global-dictionary-styles")) {
      const styleEl = document.head.createEl("style");
      styleEl.id = "global-dictionary-styles";
      styleEl.textContent = `
        .dictionary-search-container {
          display: flex;
          align-items: center;
          flex-grow: 1;
          width: 100%;
        }
        
        .dictionary-search-container input {
          width: 100%;
          padding: 8px;
          border-radius: 4px;
          border: 1px solid var(--background-modifier-border);
          background-color: var(--background-primary);
          color: var(--text-normal);
        }
        
        .dictionary-add-container {
          display: flex;
          width: 100%;
          gap: 8px;
        }
        
        .dictionary-add-input {
          flex-grow: 1;
          padding: 8px;
          border-radius: 4px;
          border: 1px solid var(--background-modifier-border);
          background-color: var(--background-primary);
          color: var(--text-normal);
        }
        
        .dictionary-add-button {
          padding: 8px 12px;
          border-radius: 4px;
          background-color: var(--interactive-accent);
          color: var(--text-on-accent);
          font-size: 0.8em;
          cursor: pointer;
          transition: background-color 0.2s;
          border: none;
        }
        
        .dictionary-add-button:hover {
          background-color: var(--interactive-accent-hover);
        }
        
        .dictionary-words-container {
          max-height: 350px;
          overflow-y: auto;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          margin-bottom: 15px;
        }
        
        .dictionary-words-list {
          padding: 10px;
        }
        
        .dictionary-words-ul {
          list-style-type: none;
          padding-left: 0;
          margin: 0;
        }
        
        .dictionary-word-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 8px 5px;
          border-bottom: 1px solid var(--background-modifier-border-hover);
          transition: background-color 0.2s;
        }
        
        .dictionary-word-item:hover {
          background-color: var(--background-modifier-hover);
        }
        
        .dictionary-word-text {
          overflow: hidden;
          text-overflow: ellipsis;
        }
        
        .dictionary-remove-button {
          padding: 4px 8px;
          background: var(--background-modifier-error-rgb);
          color: white;
          border-radius: 4px;
          font-size: 0.8em;
          opacity: 0.7;
          transition: opacity 0.2s;
          cursor: pointer;
        }
        
        .dictionary-remove-button:hover {
          opacity: 1;
        }
        
        .dictionary-empty-message {
          padding: 20px;
          text-align: center;
          color: var(--text-muted);
        }
        
        .dictionary-count {
          text-align: right;
          font-size: 0.8em;
          color: var(--text-muted);
          padding: 5px;
        }
      `;
    }
  }
};

// src/ui/modal.ts
var import_obsidian2 = require("obsidian");
var DictionaryMergeModal = class extends import_obsidian2.Modal {
  constructor(app, plugin, wordsToRemove, onConfirmRemove, onMerge) {
    super(app);
    this.plugin = plugin;
    this.wordsToRemove = wordsToRemove;
    this.onConfirmRemove = onConfirmRemove;
    this.onMerge = onMerge;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: "Dictionary Sync Conflict" });
    contentEl.createEl("p", {
      text: `${this.wordsToRemove.length} words (shown below) will be removed from your local dictionary based on the synced dictionary.`
    });
    contentEl.createEl("p", {
      text: "Do you want to remove these, or merge them into the global synced dictionary?"
    });
    const wordsContainer = contentEl.createDiv(
      "dictionary-merge-words-container"
    );
    const wordsList = wordsContainer.createEl("ul");
    const displayWords = this.wordsToRemove.slice(0, 20);
    displayWords.forEach((word) => {
      wordsList.createEl("li", { text: word });
    });
    if (this.wordsToRemove.length > 20) {
      contentEl.createEl("p", {
        text: `...and ${this.wordsToRemove.length - 20} more words`,
        cls: "dictionary-merge-more-text"
      });
    }
    const buttonContainer = contentEl.createDiv("dictionary-merge-buttons");
    new import_obsidian2.ButtonComponent(buttonContainer).setButtonText(`Remove ${this.wordsToRemove.length} Words`).setCta().onClick(() => {
      this.onConfirmRemove();
      this.close();
    });
    new import_obsidian2.ButtonComponent(buttonContainer).setButtonText("Merge Words").onClick(() => {
      this.onMerge();
      this.close();
    });
    contentEl.createEl("style", {
      text: `
        .dictionary-merge-words-container {
          max-height: 200px;
          overflow-y: auto;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          padding: 8px;
          margin-bottom: 16px;
        }
        
        .dictionary-merge-more-text {
          text-align: center;
          font-style: italic;
          color: var(--text-muted);
        }
        
        .dictionary-merge-buttons {
          display: flex;
          justify-content: space-around;
          margin-top: 20px;
          gap: 10px;
        }
      `
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  globalWords: [],
  warningThreshold: 5
};
var GlobalDictionarySyncPlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    await this.syncDictionaries(true);
    this.syncIntervalId = setInterval(async () => {
      const hasChanges = await this.checkForExternalChanges();
      if (hasChanges) {
        this.syncDictionaries(false, false);
      } else {
        this.syncDictionaries(false, true);
      }
    }, 15 * 1e3);
    console.log("Global Dictionary: Set up automatic sync every 2 minutes");
    this.settingsTab = new GlobalDictionarySettingsTab(this.app, this);
    this.addSettingTab(this.settingsTab);
    this.addCommand({
      id: "add-selection-to-synced-dictionary",
      name: "Add selection to Global Dictionary",
      editorCallback: (editor, _) => {
        const selection = editor.getSelection();
        if (selection) {
          const word = selection.trim();
          if (word) {
            privateDictAPI.addWord(word);
          } else {
            new import_obsidian3.Notice("No word selected.");
          }
        } else {
          new import_obsidian3.Notice("No word selected.");
        }
      }
    });
  }
  onunload() {
    if (this.syncIntervalId)
      clearInterval(this.syncIntervalId);
    this.syncDictionaries(false, true).catch(
      (e) => console.error("Error during final dictionary sync:", e)
    );
  }
  async syncDictionaries(showNotice = false, shouldMerge = false) {
    try {
      const localWords = await privateDictAPI.listWords();
      if (localWords && Array.isArray(localWords)) {
        const wordsToRemove = localWords.filter(
          (word) => !this.settings.globalWords.includes(word)
        );
        const wordsToAdd = this.settings.globalWords.filter(
          (word) => !localWords.includes(word)
        );
        const merge = async () => {
          let mergedCount = 0;
          let madeChanges = false;
          for (const word of wordsToRemove) {
            if (!this.settings.globalWords.includes(word)) {
              this.settings.globalWords.push(word);
              mergedCount++;
              madeChanges = true;
            }
          }
          for (const word of wordsToAdd) {
            privateDictAPI.addWord(word);
          }
          if (madeChanges) {
            this.settings.globalWords.sort(
              (a, b) => a.toLowerCase().localeCompare(b.toLowerCase())
            );
            await this.saveSettings();
          }
          return mergedCount;
        };
        if (shouldMerge) {
          merge();
          return;
        }
        if (wordsToRemove.length >= this.settings.warningThreshold) {
          const modal = new DictionaryMergeModal(
            this.app,
            this,
            wordsToRemove,
            // Function to execute if user confirms removal
            async () => {
              for (const word of wordsToRemove) {
                privateDictAPI.removeWord(word);
              }
              for (const word of wordsToAdd) {
                privateDictAPI.addWord(word);
              }
              if (showNotice) {
                new import_obsidian3.Notice(
                  `Dictionary sync complete: ${wordsToAdd.length} words added, ${wordsToRemove.length} words removed`
                );
              }
            },
            // Function to execute if user chooses to merge instead
            async () => {
              const mergedCount = await merge();
              if (showNotice) {
                new import_obsidian3.Notice(
                  `Dictionary merged: ${mergedCount} words added to global dictionary, ${wordsToAdd.length} words added to system`
                );
              }
            }
          );
          modal.open();
        } else {
          let removedFromApiCount = 0;
          for (const word of wordsToRemove) {
            privateDictAPI.removeWord(word);
            removedFromApiCount++;
          }
          let addedToApiCount = 0;
          for (const word of wordsToAdd) {
            privateDictAPI.addWord(word);
            addedToApiCount++;
          }
          if ((addedToApiCount > 0 || removedFromApiCount > 0) && showNotice) {
            new import_obsidian3.Notice(
              `Dictionary sync complete: ${addedToApiCount} words added to system, ${removedFromApiCount} removed from system`
            );
          }
        }
      }
    } catch (dictError) {
      console.error("Failed to sync dictionaries:", dictError);
    }
  }
  async checkForExternalChanges() {
    const latestData = await this.loadData();
    if (!latestData || !latestData.globalWords)
      return false;
    const currentWords = this.settings.globalWords;
    const externalWords = latestData.globalWords;
    if (currentWords.length !== externalWords.length || !currentWords.every((word) => externalWords.includes(word)) || !externalWords.every((word) => currentWords.includes(word))) {
      this.settings.globalWords = [...externalWords];
      this.settings.globalWords.sort(
        (a, b) => a.toLowerCase().localeCompare(b.toLowerCase())
      );
      this.settingsTab.refresh();
      console.log(
        `External settings file has changed, replaced in-memory dictionary with ${externalWords.length} words`
      );
      return true;
    }
    return false;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3ByaXZhdGVEaWN0QVBJLnRzIiwgInNyYy91aS9zZXR0aW5nc1RhYi50cyIsICJzcmMvdWkvbW9kYWwudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEVkaXRvciwgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFBsdWdpbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgeyBwcml2YXRlRGljdEFQSSB9IGZyb20gXCIuL3ByaXZhdGVEaWN0QVBJXCI7XG5pbXBvcnQgeyBHbG9iYWxEaWN0aW9uYXJ5U2V0dGluZ3NUYWIgfSBmcm9tIFwiLi91aS9zZXR0aW5nc1RhYlwiO1xuaW1wb3J0IHsgRGljdGlvbmFyeU1lcmdlTW9kYWwgfSBmcm9tIFwiLi91aS9tb2RhbFwiO1xuXG5pbnRlcmZhY2UgR2xvYmFsRGljdGlvbmFyeVNldHRpbmdzIHtcbiAgZ2xvYmFsV29yZHM6IHN0cmluZ1tdO1xuICB3YXJuaW5nVGhyZXNob2xkOiBudW1iZXI7XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEdsb2JhbERpY3Rpb25hcnlTZXR0aW5ncyA9IHtcbiAgZ2xvYmFsV29yZHM6IFtdLFxuICB3YXJuaW5nVGhyZXNob2xkOiA1LFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2xvYmFsRGljdGlvbmFyeVN5bmNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICBzZXR0aW5nczogR2xvYmFsRGljdGlvbmFyeVNldHRpbmdzO1xuICBzZXR0aW5nc1RhYjogR2xvYmFsRGljdGlvbmFyeVNldHRpbmdzVGFiO1xuICBzeW5jSW50ZXJ2YWxJZDogTm9kZUpTLlRpbWVvdXQ7XG5cbiAgYXN5bmMgb25sb2FkKCkge1xuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICBhd2FpdCB0aGlzLnN5bmNEaWN0aW9uYXJpZXModHJ1ZSk7XG5cbiAgICB0aGlzLnN5bmNJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaGFzQ2hhbmdlcyA9IGF3YWl0IHRoaXMuY2hlY2tGb3JFeHRlcm5hbENoYW5nZXMoKTtcbiAgICAgIGlmIChoYXNDaGFuZ2VzKSB7XG4gICAgICAgIC8vIHN5bmMgd2l0aG91dCBtZXJnaW5nLCB3ZSB3YW50IHRoZSBzb3VyY2Ugb2YgdHJ1dGhcbiAgICAgICAgLy8gdG8gZGVzdHJveSBleHRyYSB3b3Jkc1xuICAgICAgICB0aGlzLnN5bmNEaWN0aW9uYXJpZXMoZmFsc2UsIGZhbHNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIG90aGVyd2lzZSBzeW5jIHdpdGggbWVyZ2VcbiAgICAgICAgdGhpcy5zeW5jRGljdGlvbmFyaWVzKGZhbHNlLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9LCAxNSAqIDEwMDApO1xuXG4gICAgY29uc29sZS5sb2coXCJHbG9iYWwgRGljdGlvbmFyeTogU2V0IHVwIGF1dG9tYXRpYyBzeW5jIGV2ZXJ5IDIgbWludXRlc1wiKTtcblxuICAgIHRoaXMuc2V0dGluZ3NUYWIgPSBuZXcgR2xvYmFsRGljdGlvbmFyeVNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKTtcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nc1RhYik7XG5cbiAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgaWQ6IFwiYWRkLXNlbGVjdGlvbi10by1zeW5jZWQtZGljdGlvbmFyeVwiLFxuICAgICAgbmFtZTogXCJBZGQgc2VsZWN0aW9uIHRvIEdsb2JhbCBEaWN0aW9uYXJ5XCIsXG4gICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBfOiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICBpZiAoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgY29uc3Qgd29yZCA9IHNlbGVjdGlvbi50cmltKCk7XG4gICAgICAgICAgaWYgKHdvcmQpIHtcbiAgICAgICAgICAgIHByaXZhdGVEaWN0QVBJLmFkZFdvcmQod29yZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyB3b3JkIHNlbGVjdGVkLlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3IE5vdGljZShcIk5vIHdvcmQgc2VsZWN0ZWQuXCIpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgb251bmxvYWQoKSB7XG4gICAgaWYgKHRoaXMuc3luY0ludGVydmFsSWQpIGNsZWFySW50ZXJ2YWwodGhpcy5zeW5jSW50ZXJ2YWxJZCk7XG5cbiAgICAvLyBGaW5hbCBzeW5jIG9mIGRpY3Rpb25hcnkgYmVmb3JlIHVubG9hZGluZ1xuICAgIHRoaXMuc3luY0RpY3Rpb25hcmllcyhmYWxzZSwgdHJ1ZSkuY2F0Y2goKGUpID0+XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZHVyaW5nIGZpbmFsIGRpY3Rpb25hcnkgc3luYzpcIiwgZSksXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIHN5bmNEaWN0aW9uYXJpZXMoXG4gICAgc2hvd05vdGljZTogYm9vbGVhbiA9IGZhbHNlLFxuICAgIHNob3VsZE1lcmdlOiBib29sZWFuID0gZmFsc2UsXG4gICkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBsb2NhbFdvcmRzID0gYXdhaXQgcHJpdmF0ZURpY3RBUEkubGlzdFdvcmRzKCk7XG5cbiAgICAgIGlmIChsb2NhbFdvcmRzICYmIEFycmF5LmlzQXJyYXkobG9jYWxXb3JkcykpIHtcbiAgICAgICAgLy8gSWRlbnRpZnkgd29yZHMgdG8gcmVtb3ZlIGZyb20gbG9jYWwgZGljdGlvbmFyeVxuICAgICAgICBjb25zdCB3b3Jkc1RvUmVtb3ZlID0gbG9jYWxXb3Jkcy5maWx0ZXIoXG4gICAgICAgICAgKHdvcmQpID0+ICF0aGlzLnNldHRpbmdzLmdsb2JhbFdvcmRzLmluY2x1ZGVzKHdvcmQpLFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIElkZW50aWZ5IHdvcmRzIHRvIGFkZCB0byBsb2NhbCBkaWN0aW9uYXJ5XG4gICAgICAgIGNvbnN0IHdvcmRzVG9BZGQgPSB0aGlzLnNldHRpbmdzLmdsb2JhbFdvcmRzLmZpbHRlcihcbiAgICAgICAgICAod29yZCkgPT4gIWxvY2FsV29yZHMuaW5jbHVkZXMod29yZCksXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgbWVyZ2UgPSBhc3luYyAoKTogUHJvbWlzZTxudW1iZXI+ID0+IHtcbiAgICAgICAgICBsZXQgbWVyZ2VkQ291bnQgPSAwO1xuICAgICAgICAgIGxldCBtYWRlQ2hhbmdlcyA9IGZhbHNlO1xuXG4gICAgICAgICAgZm9yIChjb25zdCB3b3JkIG9mIHdvcmRzVG9SZW1vdmUpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5nbG9iYWxXb3Jkcy5pbmNsdWRlcyh3b3JkKSkge1xuICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmdsb2JhbFdvcmRzLnB1c2god29yZCk7XG4gICAgICAgICAgICAgIG1lcmdlZENvdW50Kys7XG4gICAgICAgICAgICAgIG1hZGVDaGFuZ2VzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBBZGQgbWlzc2luZyB3b3JkcyB0byBsY29hbCBkaWN0aW9uYXJ5XG4gICAgICAgICAgZm9yIChjb25zdCB3b3JkIG9mIHdvcmRzVG9BZGQpIHtcbiAgICAgICAgICAgIHByaXZhdGVEaWN0QVBJLmFkZFdvcmQod29yZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG1hZGVDaGFuZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmdsb2JhbFdvcmRzLnNvcnQoKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PlxuICAgICAgICAgICAgICBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCkpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIG1lcmdlZENvdW50O1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChzaG91bGRNZXJnZSkge1xuICAgICAgICAgIC8vIGlmIHdlIG1lcmdlIHdlIHJldHVybiBlYXJseVxuICAgICAgICAgIG1lcmdlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgd2Ugc3VycGFzcyB3YXJuaW5nIHRocmVzaG9sZCwgc2hvdyBjb25maXJtYXRpb24gZGlhbG9nXG4gICAgICAgIGlmICh3b3Jkc1RvUmVtb3ZlLmxlbmd0aCA+PSB0aGlzLnNldHRpbmdzLndhcm5pbmdUaHJlc2hvbGQpIHtcbiAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBEaWN0aW9uYXJ5TWVyZ2VNb2RhbChcbiAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgIHdvcmRzVG9SZW1vdmUsXG4gICAgICAgICAgICAvLyBGdW5jdGlvbiB0byBleGVjdXRlIGlmIHVzZXIgY29uZmlybXMgcmVtb3ZhbFxuICAgICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBSZW1vdmUgd29yZHMgZnJvbSBzeXN0ZW0gZGljdGlvbmFyeVxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IHdvcmQgb2Ygd29yZHNUb1JlbW92ZSkge1xuICAgICAgICAgICAgICAgIHByaXZhdGVEaWN0QVBJLnJlbW92ZVdvcmQod29yZCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBBZGQgbWlzc2luZyB3b3JkcyB0byBzeXN0ZW0gZGljdGlvbmFyeVxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IHdvcmQgb2Ygd29yZHNUb0FkZCkge1xuICAgICAgICAgICAgICAgIHByaXZhdGVEaWN0QVBJLmFkZFdvcmQod29yZCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoc2hvd05vdGljZSkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXG4gICAgICAgICAgICAgICAgICBgRGljdGlvbmFyeSBzeW5jIGNvbXBsZXRlOiAke3dvcmRzVG9BZGQubGVuZ3RofSB3b3JkcyBhZGRlZCwgJHt3b3Jkc1RvUmVtb3ZlLmxlbmd0aH0gd29yZHMgcmVtb3ZlZGAsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIEZ1bmN0aW9uIHRvIGV4ZWN1dGUgaWYgdXNlciBjaG9vc2VzIHRvIG1lcmdlIGluc3RlYWRcbiAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgbWVyZ2VkQ291bnQgPSBhd2FpdCBtZXJnZSgpO1xuXG4gICAgICAgICAgICAgIGlmIChzaG93Tm90aWNlKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcbiAgICAgICAgICAgICAgICAgIGBEaWN0aW9uYXJ5IG1lcmdlZDogJHttZXJnZWRDb3VudH0gd29yZHMgYWRkZWQgdG8gZ2xvYmFsIGRpY3Rpb25hcnksICR7d29yZHNUb0FkZC5sZW5ndGh9IHdvcmRzIGFkZGVkIHRvIHN5c3RlbWAsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICApO1xuICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBJZiA1IG9yIGZld2VyIHdvcmRzIHRvIHJlbW92ZSwgcHJvY2VlZCB3aXRoIG5vcm1hbCBzeW5jXG4gICAgICAgICAgbGV0IHJlbW92ZWRGcm9tQXBpQ291bnQgPSAwO1xuICAgICAgICAgIGZvciAoY29uc3Qgd29yZCBvZiB3b3Jkc1RvUmVtb3ZlKSB7XG4gICAgICAgICAgICBwcml2YXRlRGljdEFQSS5yZW1vdmVXb3JkKHdvcmQpO1xuICAgICAgICAgICAgcmVtb3ZlZEZyb21BcGlDb3VudCsrO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCBhZGRlZFRvQXBpQ291bnQgPSAwO1xuICAgICAgICAgIGZvciAoY29uc3Qgd29yZCBvZiB3b3Jkc1RvQWRkKSB7XG4gICAgICAgICAgICBwcml2YXRlRGljdEFQSS5hZGRXb3JkKHdvcmQpO1xuICAgICAgICAgICAgYWRkZWRUb0FwaUNvdW50Kys7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKChhZGRlZFRvQXBpQ291bnQgPiAwIHx8IHJlbW92ZWRGcm9tQXBpQ291bnQgPiAwKSAmJiBzaG93Tm90aWNlKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFxuICAgICAgICAgICAgICBgRGljdGlvbmFyeSBzeW5jIGNvbXBsZXRlOiAke2FkZGVkVG9BcGlDb3VudH0gd29yZHMgYWRkZWQgdG8gc3lzdGVtLCAke3JlbW92ZWRGcm9tQXBpQ291bnR9IHJlbW92ZWQgZnJvbSBzeXN0ZW1gLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChkaWN0RXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc3luYyBkaWN0aW9uYXJpZXM6XCIsIGRpY3RFcnJvcik7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY2hlY2tGb3JFeHRlcm5hbENoYW5nZXMoKSB7XG4gICAgLy8gTG9hZCB0aGUgbGF0ZXN0IGRhdGEgZnJvbSBkaXNrXG4gICAgY29uc3QgbGF0ZXN0RGF0YSA9IChhd2FpdCB0aGlzLmxvYWREYXRhKCkpIGFzIEdsb2JhbERpY3Rpb25hcnlTZXR0aW5ncztcblxuICAgIGlmICghbGF0ZXN0RGF0YSB8fCAhbGF0ZXN0RGF0YS5nbG9iYWxXb3JkcykgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGFueSBkaWZmZXJlbmNlcyBiZXR3ZWVuIGRpc2sgZGF0YSBhbmQgY3VycmVudCBtZW1vcnlcbiAgICAvLyBieSBjb21wYXJpbmcgbGVuZ3RocyBhbmQgY29udGVudHNcbiAgICBjb25zdCBjdXJyZW50V29yZHMgPSB0aGlzLnNldHRpbmdzLmdsb2JhbFdvcmRzO1xuICAgIGNvbnN0IGV4dGVybmFsV29yZHMgPSBsYXRlc3REYXRhLmdsb2JhbFdvcmRzO1xuXG4gICAgaWYgKFxuICAgICAgY3VycmVudFdvcmRzLmxlbmd0aCAhPT0gZXh0ZXJuYWxXb3Jkcy5sZW5ndGggfHxcbiAgICAgICFjdXJyZW50V29yZHMuZXZlcnkoKHdvcmQpID0+IGV4dGVybmFsV29yZHMuaW5jbHVkZXMod29yZCkpIHx8XG4gICAgICAhZXh0ZXJuYWxXb3Jkcy5ldmVyeSgod29yZCkgPT4gY3VycmVudFdvcmRzLmluY2x1ZGVzKHdvcmQpKVxuICAgICkge1xuICAgICAgLy8gY29tcGxldGVseSByZXBsYWNlIGN1cnJlbnQgc2V0dGluZ3Mgd2l0aCBleHRlcm5hbCBkYXRhXG4gICAgICB0aGlzLnNldHRpbmdzLmdsb2JhbFdvcmRzID0gWy4uLmV4dGVybmFsV29yZHNdO1xuXG4gICAgICAvLyByZXNvcnQgdGhlIGxpc3RcbiAgICAgIHRoaXMuc2V0dGluZ3MuZ2xvYmFsV29yZHMuc29ydCgoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+XG4gICAgICAgIGEudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGIudG9Mb3dlckNhc2UoKSksXG4gICAgICApO1xuXG4gICAgICAvLyByZWZyZXNoIHNldHRpbmdzIHRhYiBzbyB0aGF0IHdvcmRjb3VudHMgYW5kIHdvcmRzIHVwZGF0ZVxuICAgICAgdGhpcy5zZXR0aW5nc1RhYi5yZWZyZXNoKCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgRXh0ZXJuYWwgc2V0dGluZ3MgZmlsZSBoYXMgY2hhbmdlZCwgcmVwbGFjZWQgaW4tbWVtb3J5IGRpY3Rpb25hcnkgd2l0aCAke2V4dGVybmFsV29yZHMubGVuZ3RofSB3b3Jkc2AsXG4gICAgICApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gIH1cbn1cbiIsICIvLyBJTkZPOiBUaGlzIGNsYXNzIGlzIHByb25lIHRvIGJyZWFraW5nIGJlY2F1c2UgaXQgY2FsbHMgcHJpdmF0ZSBtZXRob2RzXG5leHBvcnQgY2xhc3MgUHJpdmF0ZURpY3RBUEkge1xuICBwcml2YXRlIHNlc3Npb246IGFueTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBjb25zdCBlbGVjdHJvbiA9IHJlcXVpcmUoXCJlbGVjdHJvblwiKSBhcyBhbnk7XG4gICAgaWYgKGVsZWN0cm9uICYmIGVsZWN0cm9uLnJlbW90ZSkge1xuICAgICAgY29uc3QgcmVtb3RlID0gZWxlY3Ryb24ucmVtb3RlO1xuICAgICAgY29uc3QgY3VycmVudFdlYkNvbnRlbnRzID0gcmVtb3RlLmdldEN1cnJlbnRXZWJDb250ZW50cygpO1xuICAgICAgdGhpcy5zZXNzaW9uID0gY3VycmVudFdlYkNvbnRlbnRzLnNlc3Npb247XG4gICAgfVxuICB9XG5cbiAgYWRkV29yZChuZXdFbnRyeTogc3RyaW5nKSB7XG4gICAgdGhpcy5zZXNzaW9uLmFkZFdvcmRUb1NwZWxsQ2hlY2tlckRpY3Rpb25hcnkobmV3RW50cnkpO1xuICB9XG5cbiAgcmVtb3ZlV29yZCh3b3JkOiBzdHJpbmcpIHtcbiAgICB0aGlzLnNlc3Npb24ucmVtb3ZlV29yZEZyb21TcGVsbENoZWNrZXJEaWN0aW9uYXJ5KHdvcmQpO1xuICB9XG5cbiAgYXN5bmMgbGlzdFdvcmRzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zZXNzaW9uLmxpc3RXb3Jkc0luU3BlbGxDaGVja2VyRGljdGlvbmFyeSgpO1xuICB9XG59XG5cbi8vIENyZWF0ZSBhIHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHByaXZhdGVEaWN0QVBJID0gbmV3IFByaXZhdGVEaWN0QVBJKCk7XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBHbG9iYWxEaWN0aW9uYXJ5U3luY1BsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xuaW1wb3J0IHsgcHJpdmF0ZURpY3RBUEkgfSBmcm9tIFwiLi4vcHJpdmF0ZURpY3RBUElcIjtcblxuZXhwb3J0IGNsYXNzIEdsb2JhbERpY3Rpb25hcnlTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IEdsb2JhbERpY3Rpb25hcnlTeW5jUGx1Z2luO1xuICBzZWFyY2hJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgd29yZHNMaXN0OiBIVE1MRWxlbWVudDtcbiAgY291bnRJbmRpY2F0b3I6IEhUTUxFbGVtZW50O1xuICBmaWx0ZXJlZFdvcmRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEdsb2JhbERpY3Rpb25hcnlTeW5jUGx1Z2luKSB7XG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICB9XG5cbiAgcmVmcmVzaCgpOiB2b2lkIHtcbiAgICB0aGlzLmZpbHRlcmVkV29yZHMgPSBbLi4udGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsV29yZHNdO1xuICAgIHRoaXMudXBkYXRlV29yZENvdW50KCk7XG4gICAgdGhpcy5yZW5kZXJXb3Jkc0xpc3QoKTtcbiAgfVxuXG4gIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImdsb2JhbC1kaWN0aW9uYXJ5LXNldHRpbmdzXCIpO1xuXG4gICAgdGhpcy5hZGRTdHlsZXMoKTtcblxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkdsb2JhbCBEaWN0aW9uYXJ5IFN5bmMgU2V0dGluZ3NcIiB9KTtcblxuICAgIC8vIE5ldyB3b3JkIGlucHV0IGFuZCBhZGQgYnV0dG9uXG4gICAgY29uc3QgYWRkV29yZFNldHRpbmcgPSBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiQWRkIFdvcmQgdG8gRGljdGlvbmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJFbnRlciBhIHdvcmQgdG8gYWRkIHRvIHlvdXIgZ2xvYmFsIGRpY3Rpb25hcnkuXCIpO1xuXG4gICAgLy8gQ3JlYXRlIGNvbnRhaW5lciBmb3IgdGhlIGlucHV0IGFuZCBidXR0b25cbiAgICBjb25zdCBhZGRXb3JkQ29udGFpbmVyID0gYWRkV29yZFNldHRpbmcuY29udHJvbEVsLmNyZWF0ZURpdihcbiAgICAgIFwiZGljdGlvbmFyeS1hZGQtY29udGFpbmVyXCIsXG4gICAgKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgaW5wdXQgZWxlbWVudFxuICAgIGNvbnN0IGFkZFdvcmRJbnB1dCA9IGFkZFdvcmRDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICBhdHRyOiB7XG4gICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICBwbGFjZWhvbGRlcjogXCJFbnRlciBhIHdvcmQuLi5cIixcbiAgICAgIH0sXG4gICAgICBjbHM6IFwiZGljdGlvbmFyeS1hZGQtaW5wdXRcIixcbiAgICB9KTtcblxuICAgIC8vIENyZWF0ZSB0aGUgYWRkIGJ1dHRvblxuICAgIGNvbnN0IGFkZFdvcmRCdXR0b24gPSBhZGRXb3JkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIHRleHQ6IFwiQWRkIFdvcmRcIixcbiAgICAgIGNsczogXCJkaWN0aW9uYXJ5LWFkZC1idXR0b25cIixcbiAgICB9KTtcblxuICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lciB0byB0aGUgYnV0dG9uXG4gICAgYWRkV29yZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgd29yZCA9IGFkZFdvcmRJbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICBpZiAod29yZCkge1xuICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbFdvcmRzLmluY2x1ZGVzKHdvcmQpKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHByaXZhdGVEaWN0QVBJLmFkZFdvcmQod29yZCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShcbiAgICAgICAgICAgICAgYE5PVEU6IFVwZGF0aW5nIGRpY3QgZG9lc24ndCB3b3JrIG9uIGlPUyAodW50ZXN0ZWQgb24gYW5kcm9pZCkuXFxuXFxuIENhbid0IHVwZGF0ZSBkaWN0aW9uYXJ5OiAke2V9LmAsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxXb3Jkcy5wdXNoKHdvcmQpO1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbFdvcmRzLnNvcnQoKGEsIGIpID0+XG4gICAgICAgICAgICBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCkpLFxuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgbmV3IE5vdGljZShgJyR7d29yZH0nIGFkZGVkIHRvIGRpY3Rpb25hcnkuYCk7XG4gICAgICAgICAgYWRkV29yZElucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgICB0aGlzLmZpbHRlcldvcmRzKCk7XG4gICAgICAgICAgdGhpcy51cGRhdGVXb3JkQ291bnQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXcgTm90aWNlKGAnJHt3b3JkfScgaXMgYWxyZWFkeSBpbiB5b3VyIGRpY3Rpb25hcnkuYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIENvbWJpbmVkIFNlYXJjaCBhbmQgRGljdGlvbmFyeSBNYW5hZ2VtZW50XG4gICAgY29uc3QgZGljdGlvbmFyeVNldHRpbmcgPSBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiU2VhcmNoIEdsb2JhbCBEaWN0aW9uYXJ5XCIpXG4gICAgICAuc2V0RGVzYyhcIlNlYXJjaCBhbmQgcmVtb3ZlIHdvcmRzIGZyb20geW91ciBkaWN0aW9uYXJ5LlwiKTtcblxuICAgIC8vIEFkZCBzZWFyY2ggaW5wdXQgdG8gdGhlIHNldHRpbmdcbiAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSBkaWN0aW9uYXJ5U2V0dGluZy5jb250cm9sRWwuY3JlYXRlRGl2KFxuICAgICAgXCJkaWN0aW9uYXJ5LXNlYXJjaC1jb250YWluZXJcIixcbiAgICApO1xuXG4gICAgdGhpcy5zZWFyY2hJbnB1dCA9IHNlYXJjaENvbnRhaW5lci5jcmVhdGVFbChcImlucHV0XCIsIHtcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgIGlkOiBcImRpY3Rpb25hcnktc2VhcmNoXCIsXG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIlR5cGUgdG8gZmlsdGVyIHdvcmRzLi4uXCIsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgdGhpcy5zZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5maWx0ZXJXb3JkcygpO1xuICAgIH0pO1xuXG4gICAgLy8gV29yZHMgbGlzdCBjb250YWluZXJcbiAgICBjb25zdCB3b3Jkc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdihcImRpY3Rpb25hcnktd29yZHMtY29udGFpbmVyXCIpO1xuICAgIHRoaXMud29yZHNMaXN0ID0gd29yZHNDb250YWluZXIuY3JlYXRlRGl2KFwiZGljdGlvbmFyeS13b3Jkcy1saXN0XCIpO1xuXG4gICAgLy8gV29yZCBjb3VudCBpbmRpY2F0b3JcbiAgICB0aGlzLmNvdW50SW5kaWNhdG9yID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KFwiZGljdGlvbmFyeS1jb3VudFwiKTtcbiAgICB0aGlzLmNvdW50SW5kaWNhdG9yLmNyZWF0ZVNwYW4oe1xuICAgICAgdGV4dDogYFRvdGFsIHdvcmRzIGluIGRpY3Rpb25hcnk6ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsV29yZHMubGVuZ3RofWAsXG4gICAgfSk7XG5cbiAgICAvLyBJbml0aWFsaXplIHRoZSB3b3JkIGxpc3RcbiAgICB0aGlzLmZpbHRlcmVkV29yZHMgPSBbLi4udGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsV29yZHNdO1xuICAgIHRoaXMucmVuZGVyV29yZHNMaXN0KCk7XG4gIH1cblxuICBmaWx0ZXJXb3JkcygpOiB2b2lkIHtcbiAgICBjb25zdCBzZWFyY2hUZXJtID0gdGhpcy5zZWFyY2hJbnB1dC52YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChzZWFyY2hUZXJtKSB7XG4gICAgICB0aGlzLmZpbHRlcmVkV29yZHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxXb3Jkcy5maWx0ZXIoKHdvcmQpID0+XG4gICAgICAgIHdvcmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKSxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZmlsdGVyZWRXb3JkcyA9IFsuLi50aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxXb3Jkc107XG4gICAgfVxuICAgIHRoaXMucmVuZGVyV29yZHNMaXN0KCk7XG4gIH1cblxuICB1cGRhdGVXb3JkQ291bnQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY291bnRJbmRpY2F0b3IpIHtcbiAgICAgIHRoaXMuY291bnRJbmRpY2F0b3IuZW1wdHkoKTtcbiAgICAgIHRoaXMuY291bnRJbmRpY2F0b3IuY3JlYXRlU3Bhbih7XG4gICAgICAgIHRleHQ6IGBUb3RhbCB3b3JkcyBpbiBkaWN0aW9uYXJ5OiAke3RoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbFdvcmRzLmxlbmd0aH1gLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyV29yZHNMaXN0KCk6IHZvaWQge1xuICAgIHRoaXMud29yZHNMaXN0LmVtcHR5KCk7XG5cbiAgICBpZiAodGhpcy5maWx0ZXJlZFdvcmRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgaWYgKHRoaXMuc2VhcmNoSW5wdXQudmFsdWUpIHtcbiAgICAgICAgdGhpcy53b3Jkc0xpc3QuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgICB0ZXh0OiBcIk5vIG1hdGNoaW5nIHdvcmRzIGZvdW5kLlwiLFxuICAgICAgICAgIGNsczogXCJkaWN0aW9uYXJ5LWVtcHR5LW1lc3NhZ2VcIixcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLndvcmRzTGlzdC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgIHRleHQ6ICdObyB3b3JkcyBpbiB0aGUgZGljdGlvbmFyeSB5ZXQuIFVzZSB0aGUgY29tbWFuZCBcIkFkZCBzZWxlY3Rpb24gdG8gR2xvYmFsIERpY3Rpb25hcnlcIiB0byBhZGQgc29tZSEnLFxuICAgICAgICAgIGNsczogXCJkaWN0aW9uYXJ5LWVtcHR5LW1lc3NhZ2VcIixcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdWwgPSB0aGlzLndvcmRzTGlzdC5jcmVhdGVFbChcInVsXCIsIHsgY2xzOiBcImRpY3Rpb25hcnktd29yZHMtdWxcIiB9KTtcblxuICAgIHRoaXMuZmlsdGVyZWRXb3Jkcy5mb3JFYWNoKCh3b3JkKSA9PiB7XG4gICAgICBjb25zdCBsaSA9IHVsLmNyZWF0ZUVsKFwibGlcIiwgeyBjbHM6IFwiZGljdGlvbmFyeS13b3JkLWl0ZW1cIiB9KTtcbiAgICAgIGxpLmNyZWF0ZVNwYW4oeyB0ZXh0OiB3b3JkLCBjbHM6IFwiZGljdGlvbmFyeS13b3JkLXRleHRcIiB9KTtcblxuICAgICAgY29uc3QgcmVtb3ZlQnV0dG9uID0gbGkuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgICB0ZXh0OiBcIlJlbW92ZVwiLFxuICAgICAgICBjbHM6IFwiZGljdGlvbmFyeS1yZW1vdmUtYnV0dG9uXCIsXG4gICAgICB9KTtcblxuICAgICAgcmVtb3ZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcHJpdmF0ZURpY3RBUEkucmVtb3ZlV29yZCh3b3JkKTtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxXb3JkcyA9XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxXb3Jkcy5maWx0ZXIoKHcpID0+IHcgIT09IHdvcmQpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIG5ldyBOb3RpY2UoYCcke3dvcmR9JyByZW1vdmVkIGZyb20gZGljdGlvbmFyeS5gKTtcbiAgICAgICAgICB0aGlzLmZpbHRlcldvcmRzKCk7IC8vIFJlZnJlc2ggdGhlIGRpc3BsYXlcbiAgICAgICAgICB0aGlzLnVwZGF0ZVdvcmRDb3VudCgpOyAvLyBVcGRhdGUgdGhlIHdvcmQgY291bnRcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIG5ldyBOb3RpY2UoXG4gICAgICAgICAgICBgTk9URTogVXBkYXRpbmcgZGljdCBkb2Vzbid0IHdvcmsgb24gaU9TICh1bnRlc3RlZCBvbiBhbmRyb2lkKS5cXG5cXG5FcnJvciByZW1vdmluZyB3b3JkOiAke2V9LmAsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRTdHlsZXMoKSB7XG4gICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdsb2JhbC1kaWN0aW9uYXJ5LXN0eWxlc1wiKSkge1xuICAgICAgY29uc3Qgc3R5bGVFbCA9IGRvY3VtZW50LmhlYWQuY3JlYXRlRWwoXCJzdHlsZVwiKTtcbiAgICAgIHN0eWxlRWwuaWQgPSBcImdsb2JhbC1kaWN0aW9uYXJ5LXN0eWxlc1wiO1xuICAgICAgc3R5bGVFbC50ZXh0Q29udGVudCA9IGBcbiAgICAgICAgLmRpY3Rpb25hcnktc2VhcmNoLWNvbnRhaW5lciB7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgIGZsZXgtZ3JvdzogMTtcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktc2VhcmNoLWNvbnRhaW5lciBpbnB1dCB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcbiAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAuZGljdGlvbmFyeS1hZGQtY29udGFpbmVyIHtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIGdhcDogOHB4O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAuZGljdGlvbmFyeS1hZGQtaW5wdXQge1xuICAgICAgICAgIGZsZXgtZ3JvdzogMTtcbiAgICAgICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC5kaWN0aW9uYXJ5LWFkZC1idXR0b24ge1xuICAgICAgICAgIHBhZGRpbmc6IDhweCAxMnB4O1xuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7XG4gICAgICAgICAgZm9udC1zaXplOiAwLjhlbTtcbiAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuICAgICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktYWRkLWJ1dHRvbjpob3ZlciB7XG4gICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LWhvdmVyKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktd29yZHMtY29udGFpbmVyIHtcbiAgICAgICAgICBtYXgtaGVpZ2h0OiAzNTBweDtcbiAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvO1xuICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktd29yZHMtbGlzdCB7XG4gICAgICAgICAgcGFkZGluZzogMTBweDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktd29yZHMtdWwge1xuICAgICAgICAgIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTtcbiAgICAgICAgICBwYWRkaW5nLWxlZnQ6IDA7XG4gICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAuZGljdGlvbmFyeS13b3JkLWl0ZW0ge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgcGFkZGluZzogOHB4IDVweDtcbiAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktd29yZC1pdGVtOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktd29yZC10ZXh0IHtcbiAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAuZGljdGlvbmFyeS1yZW1vdmUtYnV0dG9uIHtcbiAgICAgICAgICBwYWRkaW5nOiA0cHggOHB4O1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3ItcmdiKTtcbiAgICAgICAgICBjb2xvcjogd2hpdGU7XG4gICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgb3BhY2l0eTogMC43O1xuICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycztcbiAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC5kaWN0aW9uYXJ5LXJlbW92ZS1idXR0b246aG92ZXIge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC5kaWN0aW9uYXJ5LWVtcHR5LW1lc3NhZ2Uge1xuICAgICAgICAgIHBhZGRpbmc6IDIwcHg7XG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktY291bnQge1xuICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgIHBhZGRpbmc6IDVweDtcbiAgICAgICAgfVxuICAgICAgYDtcbiAgICB9XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBHbG9iYWxEaWN0aW9uYXJ5U3luY1BsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xuXG5leHBvcnQgY2xhc3MgRGljdGlvbmFyeU1lcmdlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHBsdWdpbjogR2xvYmFsRGljdGlvbmFyeVN5bmNQbHVnaW47XG4gIHdvcmRzVG9SZW1vdmU6IHN0cmluZ1tdO1xuICBvbkNvbmZpcm1SZW1vdmU6ICgpID0+IHZvaWQ7XG4gIG9uTWVyZ2U6ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgYXBwOiBBcHAsXG4gICAgcGx1Z2luOiBHbG9iYWxEaWN0aW9uYXJ5U3luY1BsdWdpbixcbiAgICB3b3Jkc1RvUmVtb3ZlOiBzdHJpbmdbXSxcbiAgICBvbkNvbmZpcm1SZW1vdmU6ICgpID0+IHZvaWQsXG4gICAgb25NZXJnZTogKCkgPT4gdm9pZCxcbiAgKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB0aGlzLndvcmRzVG9SZW1vdmUgPSB3b3Jkc1RvUmVtb3ZlO1xuICAgIHRoaXMub25Db25maXJtUmVtb3ZlID0gb25Db25maXJtUmVtb3ZlO1xuICAgIHRoaXMub25NZXJnZSA9IG9uTWVyZ2U7XG4gIH1cblxuICBvbk9wZW4oKSB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiRGljdGlvbmFyeSBTeW5jIENvbmZsaWN0XCIgfSk7XG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IGAke3RoaXMud29yZHNUb1JlbW92ZS5sZW5ndGh9IHdvcmRzIChzaG93biBiZWxvdykgd2lsbCBiZSByZW1vdmVkIGZyb20geW91ciBsb2NhbCBkaWN0aW9uYXJ5IGJhc2VkIG9uIHRoZSBzeW5jZWQgZGljdGlvbmFyeS5gLFxuICAgIH0pO1xuXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkRvIHlvdSB3YW50IHRvIHJlbW92ZSB0aGVzZSwgb3IgbWVyZ2UgdGhlbSBpbnRvIHRoZSBnbG9iYWwgc3luY2VkIGRpY3Rpb25hcnk/XCIsXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgY29udGFpbmVyIGZvciBkaXNwbGF5aW5nIHdvcmRzXG4gICAgY29uc3Qgd29yZHNDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KFxuICAgICAgXCJkaWN0aW9uYXJ5LW1lcmdlLXdvcmRzLWNvbnRhaW5lclwiLFxuICAgICk7XG4gICAgY29uc3Qgd29yZHNMaXN0ID0gd29yZHNDb250YWluZXIuY3JlYXRlRWwoXCJ1bFwiKTtcblxuICAgIC8vIFNob3cgYXQgbW9zdCAyMCB3b3JkcyB0byBhdm9pZCBleGNlc3NpdmVseSBsYXJnZSBtb2RhbHNcbiAgICBjb25zdCBkaXNwbGF5V29yZHMgPSB0aGlzLndvcmRzVG9SZW1vdmUuc2xpY2UoMCwgMjApO1xuICAgIGRpc3BsYXlXb3Jkcy5mb3JFYWNoKCh3b3JkKSA9PiB7XG4gICAgICB3b3Jkc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7IHRleHQ6IHdvcmQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBJZiB0aGVyZSBhcmUgbW9yZSB3b3JkcyB0aGFuIHdlJ3JlIHNob3dpbmdcbiAgICBpZiAodGhpcy53b3Jkc1RvUmVtb3ZlLmxlbmd0aCA+IDIwKSB7XG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogYC4uLmFuZCAke3RoaXMud29yZHNUb1JlbW92ZS5sZW5ndGggLSAyMH0gbW9yZSB3b3Jkc2AsXG4gICAgICAgIGNsczogXCJkaWN0aW9uYXJ5LW1lcmdlLW1vcmUtdGV4dFwiLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdihcImRpY3Rpb25hcnktbWVyZ2UtYnV0dG9uc1wiKTtcbiAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgIC5zZXRCdXR0b25UZXh0KGBSZW1vdmUgJHt0aGlzLndvcmRzVG9SZW1vdmUubGVuZ3RofSBXb3Jkc2ApXG4gICAgICAuc2V0Q3RhKClcbiAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgdGhpcy5vbkNvbmZpcm1SZW1vdmUoKTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgIC5zZXRCdXR0b25UZXh0KFwiTWVyZ2UgV29yZHNcIilcbiAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgdGhpcy5vbk1lcmdlKCk7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwic3R5bGVcIiwge1xuICAgICAgdGV4dDogYFxuICAgICAgICAuZGljdGlvbmFyeS1tZXJnZS13b3Jkcy1jb250YWluZXIge1xuICAgICAgICAgIG1heC1oZWlnaHQ6IDIwMHB4O1xuICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTZweDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktbWVyZ2UtbW9yZS10ZXh0IHtcbiAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgZm9udC1zdHlsZTogaXRhbGljO1xuICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLmRpY3Rpb25hcnktbWVyZ2UtYnV0dG9ucyB7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAyMHB4O1xuICAgICAgICAgIGdhcDogMTBweDtcbiAgICAgICAgfVxuICAgICAgYCxcbiAgICB9KTtcbiAgfVxuXG4gIG9uQ2xvc2UoKSB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG4gIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBcUQ7OztBQ0M5QyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFHMUIsY0FBYztBQUNaLFVBQU0sV0FBVyxRQUFRLFVBQVU7QUFDbkMsUUFBSSxZQUFZLFNBQVMsUUFBUTtBQUMvQixZQUFNLFNBQVMsU0FBUztBQUN4QixZQUFNLHFCQUFxQixPQUFPLHNCQUFzQjtBQUN4RCxXQUFLLFVBQVUsbUJBQW1CO0FBQUEsSUFDcEM7QUFBQSxFQUNGO0FBQUEsRUFFQSxRQUFRLFVBQWtCO0FBQ3hCLFNBQUssUUFBUSxnQ0FBZ0MsUUFBUTtBQUFBLEVBQ3ZEO0FBQUEsRUFFQSxXQUFXLE1BQWM7QUFDdkIsU0FBSyxRQUFRLHFDQUFxQyxJQUFJO0FBQUEsRUFDeEQ7QUFBQSxFQUVBLE1BQU0sWUFBK0I7QUFDbkMsV0FBTyxNQUFNLEtBQUssUUFBUSxrQ0FBa0M7QUFBQSxFQUM5RDtBQUNGO0FBR08sSUFBTSxpQkFBaUIsSUFBSSxlQUFlOzs7QUMzQmpELHNCQUF1RDtBQUloRCxJQUFNLDhCQUFOLGNBQTBDLGlDQUFpQjtBQUFBLEVBT2hFLFlBQVksS0FBVSxRQUFvQztBQUN4RCxVQUFNLEtBQUssTUFBTTtBQUhuQix5QkFBMEIsQ0FBQztBQUl6QixTQUFLLFNBQVM7QUFBQSxFQUNoQjtBQUFBLEVBRUEsVUFBZ0I7QUFDZCxTQUFLLGdCQUFnQixDQUFDLEdBQUcsS0FBSyxPQUFPLFNBQVMsV0FBVztBQUN6RCxTQUFLLGdCQUFnQjtBQUNyQixTQUFLLGdCQUFnQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxVQUFnQjtBQUNkLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFDeEIsZ0JBQVksTUFBTTtBQUNsQixhQUFTLEtBQUssVUFBVSxJQUFJLDRCQUE0QjtBQUV4RCxTQUFLLFVBQVU7QUFFZixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBR3RFLFVBQU0saUJBQWlCLElBQUksd0JBQVEsV0FBVyxFQUMzQyxRQUFRLHdCQUF3QixFQUNoQyxRQUFRLGdEQUFnRDtBQUczRCxVQUFNLG1CQUFtQixlQUFlLFVBQVU7QUFBQSxNQUNoRDtBQUFBLElBQ0Y7QUFHQSxVQUFNLGVBQWUsaUJBQWlCLFNBQVMsU0FBUztBQUFBLE1BQ3RELE1BQU07QUFBQSxRQUNKLE1BQU07QUFBQSxRQUNOLGFBQWE7QUFBQSxNQUNmO0FBQUEsTUFDQSxLQUFLO0FBQUEsSUFDUCxDQUFDO0FBR0QsVUFBTSxnQkFBZ0IsaUJBQWlCLFNBQVMsVUFBVTtBQUFBLE1BQ3hELE1BQU07QUFBQSxNQUNOLEtBQUs7QUFBQSxJQUNQLENBQUM7QUFHRCxrQkFBYyxpQkFBaUIsU0FBUyxZQUFZO0FBQ2xELFlBQU0sT0FBTyxhQUFhLE1BQU0sS0FBSztBQUNyQyxVQUFJLE1BQU07QUFDUixZQUFJLENBQUMsS0FBSyxPQUFPLFNBQVMsWUFBWSxTQUFTLElBQUksR0FBRztBQUNwRCxjQUFJO0FBQ0YsMkJBQWUsUUFBUSxJQUFJO0FBQUEsVUFDN0IsU0FBUyxHQUFQO0FBQ0EsZ0JBQUk7QUFBQSxjQUNGO0FBQUE7QUFBQSw0QkFBK0Y7QUFBQSxZQUNqRztBQUNBO0FBQUEsVUFDRjtBQUNBLGVBQUssT0FBTyxTQUFTLFlBQVksS0FBSyxJQUFJO0FBQzFDLGVBQUssT0FBTyxTQUFTLFlBQVk7QUFBQSxZQUFLLENBQUMsR0FBRyxNQUN4QyxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsWUFBWSxDQUFDO0FBQUEsVUFDL0M7QUFDQSxnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixjQUFJLHVCQUFPLElBQUksNEJBQTRCO0FBQzNDLHVCQUFhLFFBQVE7QUFDckIsZUFBSyxZQUFZO0FBQ2pCLGVBQUssZ0JBQWdCO0FBQUEsUUFDdkIsT0FBTztBQUNMLGNBQUksdUJBQU8sSUFBSSxzQ0FBc0M7QUFBQSxRQUN2RDtBQUFBLE1BQ0Y7QUFBQSxJQUNGLENBQUM7QUFHRCxVQUFNLG9CQUFvQixJQUFJLHdCQUFRLFdBQVcsRUFDOUMsUUFBUSwwQkFBMEIsRUFDbEMsUUFBUSwrQ0FBK0M7QUFHMUQsVUFBTSxrQkFBa0Isa0JBQWtCLFVBQVU7QUFBQSxNQUNsRDtBQUFBLElBQ0Y7QUFFQSxTQUFLLGNBQWMsZ0JBQWdCLFNBQVMsU0FBUztBQUFBLE1BQ25ELE1BQU07QUFBQSxRQUNKLE1BQU07QUFBQSxRQUNOLElBQUk7QUFBQSxRQUNKLGFBQWE7QUFBQSxNQUNmO0FBQUEsSUFDRixDQUFDO0FBRUQsU0FBSyxZQUFZLGlCQUFpQixTQUFTLE1BQU07QUFDL0MsV0FBSyxZQUFZO0FBQUEsSUFDbkIsQ0FBQztBQUdELFVBQU0saUJBQWlCLFlBQVksVUFBVSw0QkFBNEI7QUFDekUsU0FBSyxZQUFZLGVBQWUsVUFBVSx1QkFBdUI7QUFHakUsU0FBSyxpQkFBaUIsWUFBWSxVQUFVLGtCQUFrQjtBQUM5RCxTQUFLLGVBQWUsV0FBVztBQUFBLE1BQzdCLE1BQU0sOEJBQThCLEtBQUssT0FBTyxTQUFTLFlBQVk7QUFBQSxJQUN2RSxDQUFDO0FBR0QsU0FBSyxnQkFBZ0IsQ0FBQyxHQUFHLEtBQUssT0FBTyxTQUFTLFdBQVc7QUFDekQsU0FBSyxnQkFBZ0I7QUFBQSxFQUN2QjtBQUFBLEVBRUEsY0FBb0I7QUFDbEIsVUFBTSxhQUFhLEtBQUssWUFBWSxNQUFNLFlBQVk7QUFDdEQsUUFBSSxZQUFZO0FBQ2QsV0FBSyxnQkFBZ0IsS0FBSyxPQUFPLFNBQVMsWUFBWTtBQUFBLFFBQU8sQ0FBQyxTQUM1RCxLQUFLLFlBQVksRUFBRSxTQUFTLFVBQVU7QUFBQSxNQUN4QztBQUFBLElBQ0YsT0FBTztBQUNMLFdBQUssZ0JBQWdCLENBQUMsR0FBRyxLQUFLLE9BQU8sU0FBUyxXQUFXO0FBQUEsSUFDM0Q7QUFDQSxTQUFLLGdCQUFnQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxrQkFBd0I7QUFDdEIsUUFBSSxLQUFLLGdCQUFnQjtBQUN2QixXQUFLLGVBQWUsTUFBTTtBQUMxQixXQUFLLGVBQWUsV0FBVztBQUFBLFFBQzdCLE1BQU0sOEJBQThCLEtBQUssT0FBTyxTQUFTLFlBQVk7QUFBQSxNQUN2RSxDQUFDO0FBQUEsSUFDSDtBQUFBLEVBQ0Y7QUFBQSxFQUVBLGtCQUF3QjtBQUN0QixTQUFLLFVBQVUsTUFBTTtBQUVyQixRQUFJLEtBQUssY0FBYyxXQUFXLEdBQUc7QUFDbkMsVUFBSSxLQUFLLFlBQVksT0FBTztBQUMxQixhQUFLLFVBQVUsU0FBUyxLQUFLO0FBQUEsVUFDM0IsTUFBTTtBQUFBLFVBQ04sS0FBSztBQUFBLFFBQ1AsQ0FBQztBQUFBLE1BQ0gsT0FBTztBQUNMLGFBQUssVUFBVSxTQUFTLEtBQUs7QUFBQSxVQUMzQixNQUFNO0FBQUEsVUFDTixLQUFLO0FBQUEsUUFDUCxDQUFDO0FBQUEsTUFDSDtBQUNBO0FBQUEsSUFDRjtBQUVBLFVBQU0sS0FBSyxLQUFLLFVBQVUsU0FBUyxNQUFNLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUV2RSxTQUFLLGNBQWMsUUFBUSxDQUFDLFNBQVM7QUFDbkMsWUFBTSxLQUFLLEdBQUcsU0FBUyxNQUFNLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUM1RCxTQUFHLFdBQVcsRUFBRSxNQUFNLE1BQU0sS0FBSyx1QkFBdUIsQ0FBQztBQUV6RCxZQUFNLGVBQWUsR0FBRyxTQUFTLFVBQVU7QUFBQSxRQUN6QyxNQUFNO0FBQUEsUUFDTixLQUFLO0FBQUEsTUFDUCxDQUFDO0FBRUQsbUJBQWEsaUJBQWlCLFNBQVMsWUFBWTtBQUNqRCxZQUFJO0FBQ0YseUJBQWUsV0FBVyxJQUFJO0FBQzlCLGVBQUssT0FBTyxTQUFTLGNBQ25CLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxDQUFDLE1BQU0sTUFBTSxJQUFJO0FBQzNELGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGNBQUksdUJBQU8sSUFBSSxnQ0FBZ0M7QUFDL0MsZUFBSyxZQUFZO0FBQ2pCLGVBQUssZ0JBQWdCO0FBQUEsUUFDdkIsU0FBUyxHQUFQO0FBQ0EsY0FBSTtBQUFBLFlBQ0Y7QUFBQTtBQUFBLHVCQUEwRjtBQUFBLFVBQzVGO0FBQUEsUUFDRjtBQUFBLE1BQ0YsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBQ0g7QUFBQSxFQUVBLFlBQVk7QUFDVixRQUFJLENBQUMsU0FBUyxlQUFlLDBCQUEwQixHQUFHO0FBQ3hELFlBQU0sVUFBVSxTQUFTLEtBQUssU0FBUyxPQUFPO0FBQzlDLGNBQVEsS0FBSztBQUNiLGNBQVEsY0FBYztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQStHeEI7QUFBQSxFQUNGO0FBQ0Y7OztBQ2xUQSxJQUFBQyxtQkFBNEM7QUFHckMsSUFBTSx1QkFBTixjQUFtQyx1QkFBTTtBQUFBLEVBTTlDLFlBQ0UsS0FDQSxRQUNBLGVBQ0EsaUJBQ0EsU0FDQTtBQUNBLFVBQU0sR0FBRztBQUNULFNBQUssU0FBUztBQUNkLFNBQUssZ0JBQWdCO0FBQ3JCLFNBQUssa0JBQWtCO0FBQ3ZCLFNBQUssVUFBVTtBQUFBLEVBQ2pCO0FBQUEsRUFFQSxTQUFTO0FBQ1AsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUV0QixjQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFFN0QsY0FBVSxTQUFTLEtBQUs7QUFBQSxNQUN0QixNQUFNLEdBQUcsS0FBSyxjQUFjO0FBQUEsSUFDOUIsQ0FBQztBQUVELGNBQVUsU0FBUyxLQUFLO0FBQUEsTUFDdEIsTUFBTTtBQUFBLElBQ1IsQ0FBQztBQUdELFVBQU0saUJBQWlCLFVBQVU7QUFBQSxNQUMvQjtBQUFBLElBQ0Y7QUFDQSxVQUFNLFlBQVksZUFBZSxTQUFTLElBQUk7QUFHOUMsVUFBTSxlQUFlLEtBQUssY0FBYyxNQUFNLEdBQUcsRUFBRTtBQUNuRCxpQkFBYSxRQUFRLENBQUMsU0FBUztBQUM3QixnQkFBVSxTQUFTLE1BQU0sRUFBRSxNQUFNLEtBQUssQ0FBQztBQUFBLElBQ3pDLENBQUM7QUFHRCxRQUFJLEtBQUssY0FBYyxTQUFTLElBQUk7QUFDbEMsZ0JBQVUsU0FBUyxLQUFLO0FBQUEsUUFDdEIsTUFBTSxVQUFVLEtBQUssY0FBYyxTQUFTO0FBQUEsUUFDNUMsS0FBSztBQUFBLE1BQ1AsQ0FBQztBQUFBLElBQ0g7QUFFQSxVQUFNLGtCQUFrQixVQUFVLFVBQVUsMEJBQTBCO0FBQ3RFLFFBQUksaUNBQWdCLGVBQWUsRUFDaEMsY0FBYyxVQUFVLEtBQUssY0FBYyxjQUFjLEVBQ3pELE9BQU8sRUFDUCxRQUFRLE1BQU07QUFDYixXQUFLLGdCQUFnQjtBQUNyQixXQUFLLE1BQU07QUFBQSxJQUNiLENBQUM7QUFFSCxRQUFJLGlDQUFnQixlQUFlLEVBQ2hDLGNBQWMsYUFBYSxFQUMzQixRQUFRLE1BQU07QUFDYixXQUFLLFFBQVE7QUFDYixXQUFLLE1BQU07QUFBQSxJQUNiLENBQUM7QUFFSCxjQUFVLFNBQVMsU0FBUztBQUFBLE1BQzFCLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBdUJSLENBQUM7QUFBQSxFQUNIO0FBQUEsRUFFQSxVQUFVO0FBQ1IsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFBQSxFQUNsQjtBQUNGOzs7QUg1RkEsSUFBTSxtQkFBNkM7QUFBQSxFQUNqRCxhQUFhLENBQUM7QUFBQSxFQUNkLGtCQUFrQjtBQUNwQjtBQUVBLElBQXFCLDZCQUFyQixjQUF3RCx3QkFBTztBQUFBLEVBSzdELE1BQU0sU0FBUztBQUNiLFVBQU0sS0FBSyxhQUFhO0FBRXhCLFVBQU0sS0FBSyxpQkFBaUIsSUFBSTtBQUVoQyxTQUFLLGlCQUFpQixZQUFZLFlBQVk7QUFDNUMsWUFBTSxhQUFhLE1BQU0sS0FBSyx3QkFBd0I7QUFDdEQsVUFBSSxZQUFZO0FBR2QsYUFBSyxpQkFBaUIsT0FBTyxLQUFLO0FBQUEsTUFDcEMsT0FBTztBQUVMLGFBQUssaUJBQWlCLE9BQU8sSUFBSTtBQUFBLE1BQ25DO0FBQUEsSUFDRixHQUFHLEtBQUssR0FBSTtBQUVaLFlBQVEsSUFBSSwwREFBMEQ7QUFFdEUsU0FBSyxjQUFjLElBQUksNEJBQTRCLEtBQUssS0FBSyxJQUFJO0FBQ2pFLFNBQUssY0FBYyxLQUFLLFdBQVc7QUFFbkMsU0FBSyxXQUFXO0FBQUEsTUFDZCxJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixnQkFBZ0IsQ0FBQyxRQUFnQixNQUFvQjtBQUNuRCxjQUFNLFlBQVksT0FBTyxhQUFhO0FBQ3RDLFlBQUksV0FBVztBQUNiLGdCQUFNLE9BQU8sVUFBVSxLQUFLO0FBQzVCLGNBQUksTUFBTTtBQUNSLDJCQUFlLFFBQVEsSUFBSTtBQUFBLFVBQzdCLE9BQU87QUFDTCxnQkFBSSx3QkFBTyxtQkFBbUI7QUFBQSxVQUNoQztBQUFBLFFBQ0YsT0FBTztBQUNMLGNBQUksd0JBQU8sbUJBQW1CO0FBQUEsUUFDaEM7QUFBQSxNQUNGO0FBQUEsSUFDRixDQUFDO0FBQUEsRUFDSDtBQUFBLEVBRUEsV0FBVztBQUNULFFBQUksS0FBSztBQUFnQixvQkFBYyxLQUFLLGNBQWM7QUFHMUQsU0FBSyxpQkFBaUIsT0FBTyxJQUFJLEVBQUU7QUFBQSxNQUFNLENBQUMsTUFDeEMsUUFBUSxNQUFNLHVDQUF1QyxDQUFDO0FBQUEsSUFDeEQ7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLGlCQUNKLGFBQXNCLE9BQ3RCLGNBQXVCLE9BQ3ZCO0FBQ0EsUUFBSTtBQUNGLFlBQU0sYUFBYSxNQUFNLGVBQWUsVUFBVTtBQUVsRCxVQUFJLGNBQWMsTUFBTSxRQUFRLFVBQVUsR0FBRztBQUUzQyxjQUFNLGdCQUFnQixXQUFXO0FBQUEsVUFDL0IsQ0FBQyxTQUFTLENBQUMsS0FBSyxTQUFTLFlBQVksU0FBUyxJQUFJO0FBQUEsUUFDcEQ7QUFHQSxjQUFNLGFBQWEsS0FBSyxTQUFTLFlBQVk7QUFBQSxVQUMzQyxDQUFDLFNBQVMsQ0FBQyxXQUFXLFNBQVMsSUFBSTtBQUFBLFFBQ3JDO0FBRUEsY0FBTSxRQUFRLFlBQTZCO0FBQ3pDLGNBQUksY0FBYztBQUNsQixjQUFJLGNBQWM7QUFFbEIscUJBQVcsUUFBUSxlQUFlO0FBQ2hDLGdCQUFJLENBQUMsS0FBSyxTQUFTLFlBQVksU0FBUyxJQUFJLEdBQUc7QUFDN0MsbUJBQUssU0FBUyxZQUFZLEtBQUssSUFBSTtBQUNuQztBQUNBLDRCQUFjO0FBQUEsWUFDaEI7QUFBQSxVQUNGO0FBR0EscUJBQVcsUUFBUSxZQUFZO0FBQzdCLDJCQUFlLFFBQVEsSUFBSTtBQUFBLFVBQzdCO0FBRUEsY0FBSSxhQUFhO0FBQ2YsaUJBQUssU0FBUyxZQUFZO0FBQUEsY0FBSyxDQUFDLEdBQVcsTUFDekMsRUFBRSxZQUFZLEVBQUUsY0FBYyxFQUFFLFlBQVksQ0FBQztBQUFBLFlBQy9DO0FBQ0Esa0JBQU0sS0FBSyxhQUFhO0FBQUEsVUFDMUI7QUFFQSxpQkFBTztBQUFBLFFBQ1Q7QUFFQSxZQUFJLGFBQWE7QUFFZixnQkFBTTtBQUNOO0FBQUEsUUFDRjtBQUdBLFlBQUksY0FBYyxVQUFVLEtBQUssU0FBUyxrQkFBa0I7QUFDMUQsZ0JBQU0sUUFBUSxJQUFJO0FBQUEsWUFDaEIsS0FBSztBQUFBLFlBQ0w7QUFBQSxZQUNBO0FBQUE7QUFBQSxZQUVBLFlBQVk7QUFFVix5QkFBVyxRQUFRLGVBQWU7QUFDaEMsK0JBQWUsV0FBVyxJQUFJO0FBQUEsY0FDaEM7QUFHQSx5QkFBVyxRQUFRLFlBQVk7QUFDN0IsK0JBQWUsUUFBUSxJQUFJO0FBQUEsY0FDN0I7QUFFQSxrQkFBSSxZQUFZO0FBQ2Qsb0JBQUk7QUFBQSxrQkFDRiw2QkFBNkIsV0FBVyx1QkFBdUIsY0FBYztBQUFBLGdCQUMvRTtBQUFBLGNBQ0Y7QUFBQSxZQUNGO0FBQUE7QUFBQSxZQUVBLFlBQVk7QUFDVixvQkFBTSxjQUFjLE1BQU0sTUFBTTtBQUVoQyxrQkFBSSxZQUFZO0FBQ2Qsb0JBQUk7QUFBQSxrQkFDRixzQkFBc0IsaURBQWlELFdBQVc7QUFBQSxnQkFDcEY7QUFBQSxjQUNGO0FBQUEsWUFDRjtBQUFBLFVBQ0Y7QUFDQSxnQkFBTSxLQUFLO0FBQUEsUUFDYixPQUFPO0FBRUwsY0FBSSxzQkFBc0I7QUFDMUIscUJBQVcsUUFBUSxlQUFlO0FBQ2hDLDJCQUFlLFdBQVcsSUFBSTtBQUM5QjtBQUFBLFVBQ0Y7QUFFQSxjQUFJLGtCQUFrQjtBQUN0QixxQkFBVyxRQUFRLFlBQVk7QUFDN0IsMkJBQWUsUUFBUSxJQUFJO0FBQzNCO0FBQUEsVUFDRjtBQUVBLGVBQUssa0JBQWtCLEtBQUssc0JBQXNCLE1BQU0sWUFBWTtBQUNsRSxnQkFBSTtBQUFBLGNBQ0YsNkJBQTZCLDBDQUEwQztBQUFBLFlBQ3pFO0FBQUEsVUFDRjtBQUFBLFFBQ0Y7QUFBQSxNQUNGO0FBQUEsSUFDRixTQUFTLFdBQVA7QUFDQSxjQUFRLE1BQU0sZ0NBQWdDLFNBQVM7QUFBQSxJQUN6RDtBQUFBLEVBQ0Y7QUFBQSxFQUVBLE1BQU0sMEJBQTBCO0FBRTlCLFVBQU0sYUFBYyxNQUFNLEtBQUssU0FBUztBQUV4QyxRQUFJLENBQUMsY0FBYyxDQUFDLFdBQVc7QUFBYSxhQUFPO0FBSW5ELFVBQU0sZUFBZSxLQUFLLFNBQVM7QUFDbkMsVUFBTSxnQkFBZ0IsV0FBVztBQUVqQyxRQUNFLGFBQWEsV0FBVyxjQUFjLFVBQ3RDLENBQUMsYUFBYSxNQUFNLENBQUMsU0FBUyxjQUFjLFNBQVMsSUFBSSxDQUFDLEtBQzFELENBQUMsY0FBYyxNQUFNLENBQUMsU0FBUyxhQUFhLFNBQVMsSUFBSSxDQUFDLEdBQzFEO0FBRUEsV0FBSyxTQUFTLGNBQWMsQ0FBQyxHQUFHLGFBQWE7QUFHN0MsV0FBSyxTQUFTLFlBQVk7QUFBQSxRQUFLLENBQUMsR0FBVyxNQUN6QyxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsWUFBWSxDQUFDO0FBQUEsTUFDL0M7QUFHQSxXQUFLLFlBQVksUUFBUTtBQUV6QixjQUFRO0FBQUEsUUFDTiwwRUFBMEUsY0FBYztBQUFBLE1BQzFGO0FBQ0EsYUFBTztBQUFBLElBQ1Q7QUFFQSxXQUFPO0FBQUEsRUFDVDtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ25CLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDM0U7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNuQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNuQztBQUNGOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
